---
title: A Little Bit of This, A Little Bit of That
author: Justin Yang
date: '2022-03-25'
slug: 
categories: [Administration]
tags: []
toc: yes
output:
  html_document:
    keep_md: yes
---


<div id="TOC">

</div>

<p>Iâ€™ve had a few days to get used to Blogdown, Hugo, and Xmin now, and of course I immediately took to tinkering. This is just a short post to highlight some of the changes Iâ€™ve made and to whom I owe thanks.</p>
<div id="last-things-first-footnotes-that-is" class="section level2">
<h2>Last Things, First (Footnotes, That Is)</h2>
<p>There is nothing inherently wrong with how Hugo Xmin handles footnotes and some might go so far as to say it is elegant. Still, based on personal preference, I have wrapped my footnotes with <a href="https://github.com/goblindegook/littlefoot">littlefoot.js</a> which, for, me, has nicer footnotes which are a bit easier to deal with, especially on mobile. I also didnâ€™t want a super lengthy front page so it was nice to hide my chatty footnotes that way.</p>
<p>I added this to my foot_custom.html file after seeing <a href="https://discourse.gohugo.io/t/littlefoot-for-fancy-popup-footnotes/23991">this post</a> on the Hugo forums. Iâ€™m very aware that this makes the page potentially load more slowly, so Iâ€™m keeping an eye out on performance.</p>
<pre class="html"><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/littlefoot/dist/littlefoot.css&quot; /&gt;
&lt;script src=&quot;https://unpkg.com/littlefoot/dist/littlefoot.js&quot; type=&quot;application/javascript&quot; &gt;&lt;/script&gt; 
&lt;script type=&quot;application/javascript&quot;&gt; littlefoot.default() &lt;/script&gt;</code></pre>
</div>
<div id="better-publication-lists-through-automation" class="section level2">
<h2>Better Publication Lists Through Automation</h2>
<p>One big goal for this iteration of my personal academic webpage was to minimise the time I spend manually updating content. I was very inspired by <a href="https://thackl.github.io/automatically-update-publications-with-R-scholar">Thomas Hacklâ€™s work on this</a> but I changed things up a little to suit my purpose as follows:</p>
<pre class="r"><code>library(scholar)
library(tidyverse)

publications &lt;- as_tibble(get_publications(&quot;o-MsbBYAAAAJ&quot;)) %&gt;%
  arrange(desc(year)) %&gt;% 
  mutate(author=str_replace_all(author, &quot;([A-Z]) ([A-Z]) &quot;, &quot;\\1\\2 &quot;),
     author=str_replace_all(author, &quot;, \\.\\.\\.&quot;, &quot; et al&quot;),
     author=str_replace_all(author, &quot;JC Yang&quot;, &quot;**JC Yang**&quot;),
     author=str_replace_all(author, &quot;J Yang&quot;, &quot;**J Yang**&quot;), 
     title=str_replace_all(title, &quot;:.+&quot;, &quot;&quot;)) %&gt;%
  mutate(citation = paste0(author,&quot;. &quot;,&quot;(&quot;,year,&quot;).&quot;,&quot; &quot;,&quot;[&quot;,title,&quot;]&quot;,&quot;(https://scholar.google.com/scholar?oi=bibs&amp;cluster=&quot;,cid,&quot;&amp;btnI=1&amp;hl=en)&quot;,&quot;. &quot;,&quot;*&quot;,journal,&quot;*&quot;,&quot; &quot;,number,&quot;.&quot;)) %&gt;%
  select(citation)

publications %&gt;% knitr::kable(&quot;html&quot;, col.names = NULL)</code></pre>
</div>
<div id="frankenstein-solutions-for-peer-reviews" class="section level2">
<h2>Frankenstein Solutions for Peer Reviews</h2>
<p>I also wanted to be able to share an unordered list of publications for which I have served as an invited referee. I use Publons to track these and I push from Publons to ORCID, so when I came across the rorcid package, I knew I was onto something good! I managed to make this work (probably inelegantly) with a lot of help from <a href="https://ciakovx.github.io/rorcid.html">Clarkeâ€™s great walk through of rorcid</a> and <a href="https://github.com/ropensci/rorcid/issues/52#issuecomment-426689902">gorkangâ€™s solution to the issue of errors</a> when using rcrossref::cr_journals. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<pre class="r"><code>library(tidyverse)
library(janitor)
library(rorcid)
library(rcrossref)
library(stringi)
reviews &lt;-
  orcid_peer_reviews(&quot;0000-0003-2881-4906&quot;)[[1]]$group$`peer-review-group` %&gt;%
  map_dfr(pluck, &quot;peer-review-summary&quot;) %&gt;%
  as_tibble() %&gt;%
  clean_names() %&gt;%
  select(review_group_id) %&gt;%
  distinct() %&gt;%
  mutate(issn = stri_enc_toutf8(str_replace(review_group_id, &quot;issn:&quot;, &quot;&quot;))) %&gt;%
  select(issn)
get_title_from_issn &lt;- function(issn) {
  tryCatch(
    issn_title[[issn]],
    error = function(e) {
      rcrossref::cr_journals(issn)$data$title
    }
  )
}
journal_names &lt;-</code></pre>
</div>
<div id="ill-show-you-mine-you-show-me-yours" class="section level2">
<h2>Iâ€™ll Show You Mine, You Show Me Yours</h2>
<p>I wanted an easy way to share my presentations so users could view them on mobile devices easily. Moving forward, Iâ€™d really like to make more use of <a href="https://revealjs.com">reveal.js</a> because itâ€™s just really nice and slick but I might rely on Beamer for more technical presentations (and anyway, I needed to a way to share PDFs of older presentations when I used a lot more PowerPoint and Stataâ€¦). So I had two things to accomplish, really.</p>
<p>For reveal.js, I came across <a href="https://taipapamotohus.com/post/how-to-create-presentation-slides-by-reveal-dot-js-and-org-mode-org-reveal-part3">taipapaâ€™s shortcode for embedding reveal.js presentations</a>, which I shamelessly borrowed for this page by adding the following shortcode:</p>
<pre class="html"><code>&lt;iframe src=&quot;{{.Get 0}}&quot; width=&quot;1000&quot; height=&quot;600&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;allowfullscreen&quot; allow=&quot;geolocation *; microphone *; camera *; midi *; encrypted-media *&quot;&gt;&lt;/iframe&gt;</code></pre>
<p>For PDFs, I wanted something relatively light and which could render decently on mobile devices. I ended up settling on a solution using PDF.js which I came across from <a href="https://github.com/anvithks/hugo-embed-pdf-shortcode">anvithks</a>, but I didnâ€™t want to have to keep the javascript updated, so I ended up using CDNJS for PDF.js with minor modifications to the shortcode:</p>
<pre class="html"><code>&lt;script type=&quot;text/javascript&quot; src = &#39;https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js&#39;&gt;&lt;/script&gt;
&lt;style&gt;
#the-canvas {
  border: 1px solid black;
  direction: ltr;
  width: 100%;
  height: auto;
  display: none;
}

#paginator {
  display: none;
  text-align: center;
  margin-bottom: 10px;
}

#loadingWrapper {
  display: none;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 350px;
}

#loading {
  display: inline-block;
  width: 50px;
  height: 50px;
  border: 3px solid #d2d0d0;;
  border-radius: 50%;
  border-top-color: #383838;
  animation: spin 1s ease-in-out infinite;
  -webkit-animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { -webkit-transform: rotate(360deg); }
}
@-webkit-keyframes spin {
  to { -webkit-transform: rotate(360deg); }
}
&lt;/style&gt;

&lt;div id=&quot;paginator&quot;&gt;
    &lt;button id=&quot;prev&quot;&gt;Previous&lt;/button&gt;
    &lt;button id=&quot;next&quot;&gt;Next&lt;/button&gt;
    &amp;nbsp; &amp;nbsp;
    &lt;span&gt;Page: &lt;span id=&quot;page_num&quot;&gt;&lt;/span&gt; / &lt;span id=&quot;page_count&quot;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div id=&quot;embed-pdf-container&quot;&gt;
    &lt;div id=&quot;loadingWrapper&quot;&gt;
      &lt;div id=&quot;loading&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;canvas id=&quot;the-canvas&quot;&gt;&lt;/canvas&gt;
&lt;/div&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
window.onload = function() {
// If absolute URL from the remote server is provided, configure the CORS
// header on that server.
var url = &#39;{{ .Get &quot;url&quot; }}&#39;;

var hidePaginator = &quot;{{ .Get &quot;hidePaginator&quot; }}&quot; === &quot;true&quot;;
var hideLoader = &quot;{{ .Get &quot;hideLoader&quot; }}&quot; === &quot;true&quot;;
var selectedPageNum = parseInt(&quot;{{ .Get &quot;renderPageNum&quot; }}&quot;) || 1;

// Loaded via &lt;script&gt; tag, create shortcut to access PDF.js exports.
var pdfjsLib = window[&#39;pdfjs-dist/build/pdf&#39;];

// The workerSrc property shall be specified.
pdfjsLib.GlobalWorkerOptions.workerSrc = &#39;https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.worker.min.js&#39;;

// Change the Scale value for lower or higher resolution.
var pdfDoc = null,
    pageNum = selectedPageNum,
    pageRendering = false,
    pageNumPending = null,
    scale = 3,
    canvas = document.getElementById(&#39;the-canvas&#39;),
    ctx = canvas.getContext(&#39;2d&#39;),
    paginator = document.getElementById(&quot;paginator&quot;),
    loadingWrapper = document.getElementById(&#39;loadingWrapper&#39;);


// Attempt to show paginator and loader if enabled
showPaginator();
showLoader();

/**
 * Get page info from document, resize canvas accordingly, and render page.
 * @param num Page number.
 */
function renderPage(num) {
  pageRendering = true;
  // Using promise to fetch the page
  pdfDoc.getPage(num).then(function(page) {
    var viewport = page.getViewport({scale: scale});
    canvas.height = viewport.height;
    canvas.width = viewport.width;

    // Render PDF page into canvas context
    var renderContext = {
      canvasContext: ctx,
      viewport: viewport
    };
    var renderTask = page.render(renderContext);

    // Wait for rendering to finish
    renderTask.promise.then(function() {
      pageRendering = false;
      showContent();
      
      if (pageNumPending !== null) {
        // New page rendering is pending
        renderPage(pageNumPending);
        pageNumPending = null;
      }
    });
  });

  // Update page counters
  document.getElementById(&#39;page_num&#39;).textContent = num;
}

/**
 * Hides loader and shows canvas
 */
function showContent() {
  loadingWrapper.style.display = &#39;none&#39;;
  canvas.style.display = &#39;block&#39;;
}

/**
 * If we haven&#39;t disabled the loader, show loader and hide canvas
 */
function showLoader() {
  if(hideLoader) return
  loadingWrapper.style.display = &#39;flex&#39;;
  canvas.style.display = &#39;none&#39;;
}

/**
 * If we haven&#39;t disabled the paginator, show paginator
 */
function showPaginator() {
  if(hidePaginator) return
  paginator.style.display = &#39;block&#39;;
}

/**
 * If another page rendering in progress, waits until the rendering is
 * finished. Otherwise, executes rendering immediately.
 */
function queueRenderPage(num) {
  if (pageRendering) {
    pageNumPending = num;
  } else {
    renderPage(num);
  }
}

/**
 * Displays previous page.
 */
function onPrevPage() {
  if (pageNum &lt;= 1) {
    return;
  }
  pageNum--;
  queueRenderPage(pageNum);
}
document.getElementById(&#39;prev&#39;).addEventListener(&#39;click&#39;, onPrevPage);

/**
 * Displays next page.
 */
function onNextPage() {
  if (pageNum &gt;= pdfDoc.numPages) {
    return;
  }
  pageNum++;
  queueRenderPage(pageNum);
}
document.getElementById(&#39;next&#39;).addEventListener(&#39;click&#39;, onNextPage);

/**
 * Asynchronously downloads PDF.
 */
pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
  pdfDoc = pdfDoc_;
  var numPages = pdfDoc.numPages;
  document.getElementById(&#39;page_count&#39;).textContent = numPages;
  
  // If the user passed in a number that is out of range, render the last page.
  if(pageNum &gt; numPages) {
    pageNum = numPages
  }

  // Initial/first page rendering
  renderPage(pageNum);
});
}

&lt;/script&gt;</code></pre>
</div>
<div id="shiny-pretty-things" class="section level2">
<h2>Shiny, Pretty Things</h2>
<p>Hugo-Academic makes great use of Font Awesome and Academicons, and though Iâ€™m aware that they are a bit superfluous and self-indulgent, I added this here anyway because I liked them. Again, another performance hit, so Iâ€™m keeping my eye on things, but I think itâ€™s not too bad, right? All I had to do was added these to head_custom.html:</p>
<pre class="html"><code>&lt;link href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.2/css/academicons.min.css&quot; rel=&quot;stylesheet&quot;&gt;</code></pre>
</div>
<div id="talk-to-me" class="section level2">
<h2>Talk to Me</h2>
<p>Finally, I didnâ€™t want too much clutter on my pages, but I didnâ€™t mind having a dialogue with people with respect to these notes and with presentations. I came across <a href="https://www.mpaulacaldas.com/post/2020/03/25/hello-hugo-xmin-comments/">MarÃ­a Paulaâ€™s great guide to getting utteranc.es set up</a> and it worked like a charm! All I had to do was added the following to my notes and presentations pages:</p>
<pre class="html"><code>{{ if not .Params.disable_comments }}
&lt;script src=&quot;https://utteranc.es/client.js&quot;
        repo=&quot;yangjustinc/yangjustinc.github.io&quot;
        issue-term=&quot;title&quot;
        label=&quot;ðŸ’¬&quot;
        theme=&quot;github-light&quot;
        crossorigin=&quot;anonymous&quot;
        async&gt;
&lt;/script&gt;
          {{ end }}</code></pre>
</div>
<div id="final-thoughts" class="section level2">
<h2>Final Thoughts</h2>
<p>This has been a huge learning opportunity and itâ€™s been so much fun! Iâ€™ve learned a lot just by trying things and seeing what works and what doesnâ€™t. <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Of course, I would be nowhere without <a href="https://yihui.org">Yihui Xie</a> and the great <a href="https://bookdown.org/yihui/blogdown/">blogdown book</a>! I hope to keep learning and making this little corner of the internet my own. Thanks for being part of my journey!</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Fun fact, I got all caught up in <a href="https://www.crossref.org/blog/outage-of-march-24-2022">the great Crossref outage on March 24</a>, and couldnâ€™t knit that page after making some updates! I thought I broke the API or something, but I was relieved to find out it wasnâ€™t my fault!<a href="#fnref1" class="footnote-back">â†©ï¸Ž</a></p></li>
<li id="fn2"><p>Iâ€™m sure there are still many things that donâ€™t work, so please, if you come across something like that, just let me know!<a href="#fnref2" class="footnote-back">â†©ï¸Ž</a></p></li>
</ol>
</div>
