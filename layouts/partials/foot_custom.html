<script defer src="//yihui.org/js/math-code.js"></script>
<script src="//cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script defer src="//yihui.org/js/center-img.js"></script>

<!-- littlefoot -->
<script src="//unpkg.com/littlefoot/dist/littlefoot.js" type="application/javascript" defer></script>

<!-- AOS -->
<script src="//unpkg.com/aos@2.3.4/dist/aos.js" defer></script>

<script defer>
document.addEventListener('DOMContentLoaded', function () {
  // Initialise littlefoot safely if you use it
  if (window.littlefoot && typeof littlefoot.default === 'function') {
    try { littlefoot.default(); } catch (e) { console.warn('littlefoot init failed:', e); }
  }

  // Pick a safe container and broad selectors
  var container = document.querySelector('main, .content, .post, .single, body');
  if (!container) container = document.body;

  var targets = container.querySelectorAll([
    'p','li','img','figure','blockquote',
    'h1','h2','h3','h4','section'
  ].join(','));

  targets.forEach(function (el) {
    // Avoid animating header, nav, footer
    if (el.closest('header, nav, footer')) return;
    if (!el.hasAttribute('data-aos')) el.setAttribute('data-aos', 'fade-up');
  });

  if (window.AOS && typeof AOS.init === 'function') {
    AOS.init({
      disable: function () {
        return window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      },
      once: true,
      offset: 80,
      duration: 600,
      easing: 'ease-in-out'
    });
  }

  // If MathJax typesets after init, refresh AOS so positions are correct
  if (window.MathJax && MathJax.startup && MathJax.startup.promise) {
    MathJax.startup.promise.then(function () {
      if (window.AOS && typeof AOS.refreshHard === 'function') AOS.refreshHard();
    }).catch(function(){});
  }
});
</script>